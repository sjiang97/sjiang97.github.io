<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Energy simulation website | Shaokang&#39;s Blog</title><meta name="keywords" content="energy simulation, see 3D model in real, Blog"><link rel="alternate" href="/rss2.xml" title="Shaokang's Blog"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css"><link href="/css/table.css" type="text/css" rel="stylesheet" media="screen,projection"><link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet"><link rel="stylesheet" href="/style.css"><script>function setLoadingBarProgress(e){document.getElementById("loading-bar").style.width=e+"%"}</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script><link rel="alternate" href="/rss2.xml" title="Shaokang's Blog" type="application/rss+xml"></head><body><div id="cover-wrapper-cover" class="cover-wrapper"><cover class="cover post half"><h1 class="title">Shaokang's Blog</h1><div class="m_search"><form name="searchform" class="form u-search-form"><input type="text" class="input u-search-input" placeholder="search"> <i class="icon fas fa-search fa-fw"></i></form></div><div class="menu navgation"><ul class="h-list"><li><a class="nav home" href="/" id="home"><i class="fas fa-rss fa-fw"></i>&nbsp;Recent</a></li><li><a class="nav home" href="/projects/" id="projects"><i class="fas fa-code-branch fa-fw"></i>&nbsp;Projects</a></li><li><a class="nav home" href="https://resume.shaokang.ga/" rel="nofollow" id="https:resume.shaokang.ga"><i class="fas fa-book fa-fw"></i>&nbsp;Resume</a></li><li><a class="nav home" href="/about/" rel="nofollow" id="about"><i class="fas fa-info-circle fa-fw"></i>&nbsp;About</a></li></ul></div></cover><header class="l_header material"><div id="loading-bar-wrapper"><div id="loading-bar" class="material"></div></div><div class="wrapper"><div class="nav-main container container--flex"><a class="logo flat-box" href="/">Shaokang's Blog</a><div class="menu navgation"><ul class="h-list"><li><a class="nav flat-box" href="/" id="home"><i class="fas fa-grin fa-fw"></i>&nbsp;Recent</a></li><li><a class="nav flat-box" href="/categories/" rel="nofollow" id="categories"><i class="fas fa-folder-open fa-fw"></i>&nbsp;Category</a></li><li><a class="nav flat-box" href="/tags/" rel="nofollow" id="tags"><i class="fas fa-hashtag fa-fw"></i>&nbsp;Tags</a></li><li><a class="nav flat-box" href="/archives/" rel="nofollow" id="archives"><i class="fas fa-archive fa-fw"></i>&nbsp;Archive</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><input type="text" class="input u-search-input" placeholder="Search"> <i class="icon fas fa-search fa-fw"></i></form></div><ul class="switcher h-list"><li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li><li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li></ul></div><div class="nav-sub container container--flex"><a class="logo flat-box"></a><ul class="switcher h-list"><li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li><li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li></ul></div></div></header><aside class="menu-phone"><header><nav class="menu navgation"><ul><li><a class="nav flat-box" href="/" id="home"><i class="fas fa-clock fa-fw"></i>&nbsp;Recent</a></li><li><a class="nav flat-box" href="/archives/" rel="nofollow" id="archives"><i class="fas fa-archive fa-fw"></i>&nbsp;Archive</a></li><li><a class="nav flat-box" href="/projects/" id="projects"><i class="fas fa-code-branch fa-fw"></i>&nbsp;Project</a></li><li><a class="nav flat-box" href="/categories/" rel="nofollow" id="categories"><i class="fas fa-folder-open fa-fw"></i>&nbsp;Category</a></li><li><a class="nav flat-box" href="/tags/" rel="nofollow" id="tags"><i class="fas fa-hashtag fa-fw"></i>&nbsp;Tags</a></li><li><a class="nav flat-box" href="https://resume.shaokang.ga/" rel="nofollow" id="https:resume.shaokang.ga"><i class="fas fa-book fa-fw"></i>&nbsp;Resume</a></li><li><a class="nav flat-box" href="/about/" rel="nofollow" id="about"><i class="fas fa-info-circle fa-fw"></i>&nbsp;About</a></li></ul></nav></header></aside><script>setLoadingBarProgress(40)</script></div><div class="l_body"><div class="body-wrapper"><div class="l_main"><article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title"><a href="/2020/Energy-smulation-website/">Energy simulation website</a></h1><div class="new-meta-box"><div class="new-meta-item author"><a href="https://shaokang.ga" rel="nofollow"><i class="fas fa-user" aria-hidden="true"></i><p>Shaokang Jiang</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-calendar-alt" aria-hidden="true"></i><p>06/15/2020</p></a></div><div class="new-meta-item category"><a href="/categories/optimization/" rel="nofollow"><i class="fas fa-folder-open" aria-hidden="true"></i><p>optimization</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>In a system where multiple types of energy source exist, running all components at all available times could be a waste by considering multiple different factors, including the device depreciation, normal energy in maintaining the entire system running. This waste is a significant factor when lower wind for wind producer happen, or lower light for light producer happen, or other stuff.</p><p>This is a web based energy running simulation simulator with jsLpsolver to find optimal threshold, which will be used to determine the time to turn on the device and time to turn off. It contains methods to analyze history data to predict a threshold to make the entire system running as efficient as it could. After proper data is provided, system will run based on a threshold setting from user or automatically analyzed based on history data so that no energy will be wasted. This app is done solely by me. More details is as below:</p><a id="more"></a><h2 id="ways-of-analyzing-history-data"><a class="markdownIt-Anchor" href="#ways-of-analyzing-history-data"></a> Ways of analyzing history data</h2><p>If <code>Using the first 30 input data to optimize and get the best possible threshold.</code> is checked, the first 30 data will be used to generate the optimized threshold.</p><p>By comparing methods in passage <a href="https://shaokang.ga/2020/Optimal-Energy-Production/">Optimal Energy Production</a> designed by me and the usage case, the following one is chosen:</p><h3 id="define-variables"><a class="markdownIt-Anchor" href="#define-variables"></a> Define variables</h3><p>J : type of energy, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>∈</mo></mrow><annotation encoding="application/x-tex">J\in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="strut bottom" style="height:.72243em;vertical-align:-.0391em"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:.09618em">J</span><span class="mrel">∈</span></span></span></span> {wind, water, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.31em"></span><span class="strut bottom" style="height:.31em;vertical-align:0"></span><span class="base textstyle uncramped"><span class="minner">⋯</span></span></span></span> }</p><p>N : value index, 1, 2, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.31em"></span><span class="strut bottom" style="height:.31em;vertical-align:0"></span><span class="base textstyle uncramped"><span class="minner">⋯</span></span></span></span>.</p><p>C = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi mathvariant="bold">R</mi></mrow><mi>J</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{R}^J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.8413309999999999em"></span><span class="strut bottom" style="height:.8413309999999999em;vertical-align:0"></span><span class="base textstyle uncramped"><span><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span><span class="vlist"><span style="top:-.363em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.09618em">J</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>: the normal energy consumption per unit time for each producer (Need to consider as a combination of multiple equipments, like: if we have two wind machine(user is able to define this in control), each machine will consume 10 W. Then <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>w</mi><mi>i</mi><mi>n</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{wind}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68333em"></span><span class="strut bottom" style="height:.83333em;vertical-align:-.15em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:.07153em">C</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:-.07153em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">d</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>=10*2=20)</p><p>U = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68611em"></span><span class="strut bottom" style="height:.68611em;vertical-align:0"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span>: Total user consumption</p><p>W = <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi mathvariant="bold">R</mi></mrow><mrow><mi>J</mi><mo separator="true">,</mo><mi>N</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{R}^{J,N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.8413309999999999em"></span><span class="strut bottom" style="height:.8413309999999999em;vertical-align:0"></span><span class="base textstyle uncramped"><span><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span><span class="vlist"><span style="top:-.363em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:.09618em">J</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:.10903em">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, the expected energy(total in above table) produced in each value index, either pre-calculated or calculate in model.</p><p>S = {0,1}<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow></mrow><mrow><mi>J</mi><mo separator="true">,</mo><mi>N</mi></mrow></msup></mrow><annotation encoding="application/x-tex">^{J,N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.8413309999999999em"></span><span class="strut bottom" style="height:.8413309999999999em;vertical-align:0"></span><span class="base textstyle uncramped"><span class="mord"><span></span><span class="vlist"><span style="top:-.363em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:.09618em">J</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:.10903em">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, to indicate I should turn on wind on this statistic data or not</p><p>B <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∈</mo><mrow><mi mathvariant="bold">R</mi></mrow></mrow><annotation encoding="application/x-tex">\in \mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.68611em"></span><span class="strut bottom" style="height:.72521em;vertical-align:-.0391em"></span><span class="base textstyle uncramped"><span class="mrel">∈</span><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span> : The battery charging limitation.</p><p>D <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∈</mo><msup><mrow><mi mathvariant="bold">R</mi></mrow><mrow><mi>J</mi><mo separator="true">,</mo><mi>N</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\in \mathbf{R}^{J,N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.8413309999999999em"></span><span class="strut bottom" style="height:.880431em;vertical-align:-.0391em"></span><span class="base textstyle uncramped"><span class="mrel">∈</span><span><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span><span class="vlist"><span style="top:-.363em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:.09618em">J</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:.10903em">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">​</span></span>​</span></span></span></span></span></span>, indicate the day count each value index, either pre-calculated or calculate in model.</p><h3 id="optimization-model"><a class="markdownIt-Anchor" href="#optimization-model"></a> Optimization Model</h3>\begin{equation}\begin{split}&\text{Minimize } & \sum_{i\in N}\sum_{j\in J}D_{ij}S_{ij}\\& \text{Subject to}\ & 0 \le S_{ij} \le 1 \ \forall i\in N j\in J\\& & \sum_{i\in N}\sum_{j\in J}W_{ij}S_{ij}-\sum_{i\in N}\sum_{j\in J}C_{j}S_{ij}-U\ge B\end{split}\end{equation}<p>Use MIP to solve it</p><h3 id="code-to-solve-it"><a class="markdownIt-Anchor" href="#code-to-solve-it"></a> Code to solve it</h3><p>This code including reading data from file using papaparse, papaparse also contains ways to read stream. Such that streaming data would be easily handled in the real situation. And the optimization is solved by using jsLpsolver.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> days = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> model = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> result;</span><br><span class="line"><span class="keyword">var</span> freq = <span class="built_in">parseFloat</span>(<span class="built_in">document</span>.getElementById(<span class="string">"freq"</span>).value) / <span class="number">3600000</span>;</span><br><span class="line"><span class="built_in">console</span>.log(freq);</span><br><span class="line">model[<span class="string">"optimize"</span>] = <span class="string">"count"</span>;</span><br><span class="line">model[<span class="string">"opType"</span>] = <span class="string">"min"</span>;</span><br><span class="line">model[<span class="string">"constraints"</span>] = &#123;&#125;;</span><br><span class="line">model[<span class="string">"variables"</span>] = &#123;&#125;;</span><br><span class="line">model[<span class="string">"ints"</span>] = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> data_input = &#123;&#125;;</span><br><span class="line">Papa.parse(file, &#123;</span><br><span class="line">    header: <span class="literal">true</span>,</span><br><span class="line">    skipEmptyLines: <span class="literal">true</span>,</span><br><span class="line">    dynamicTyping: <span class="literal">true</span>,</span><br><span class="line">    step: <span class="function"><span class="keyword">function</span>(<span class="params">results, parser</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//console.log("Row data:", results.data);</span></span><br><span class="line">        <span class="comment">//analyze data at here</span></span><br><span class="line">        <span class="comment">//use == " " || == null to check empty</span></span><br><span class="line">        <span class="keyword">if</span> (!(results.data[<span class="string">"wind_value"</span>] == <span class="string">" "</span> || results.data[<span class="string">"wind_value"</span>] == <span class="literal">null</span>)) &#123;</span><br><span class="line">            <span class="keyword">var</span> variable_wind = <span class="string">"v"</span> + idx + <span class="string">"0"</span>;</span><br><span class="line">            data_input[variable_wind] = results.data[<span class="string">"wind_value"</span>];</span><br><span class="line">            model.ints[variable_wind] = <span class="number">1</span>;</span><br><span class="line">            model.variables[variable_wind] = &#123;</span><br><span class="line">                <span class="string">"value"</span>: results.data[<span class="string">"wind_value"</span>] * results.data[<span class="string">"wind_count"</span>] * freq,</span><br><span class="line">                <span class="string">"count"</span>: results.data[<span class="string">"wind_count"</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            model.variables[variable_wind][variable_wind] = <span class="number">1</span>;</span><br><span class="line">            model.constraints[variable_wind] = &#123;</span><br><span class="line">                <span class="string">"min"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="string">"max"</span>: <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">            days += results.data[<span class="string">"wind_count"</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!(results.data[<span class="string">"light_value"</span>] == <span class="string">" "</span> || results.data[<span class="string">"light_value"</span>] == <span class="literal">null</span>)) &#123;</span><br><span class="line">            <span class="keyword">var</span> variable_light = <span class="string">"v"</span> + idx + <span class="string">"1"</span>;</span><br><span class="line">            data_input[variable_light] = results.data[<span class="string">"light_value"</span>];</span><br><span class="line">            model.ints[variable_light] = <span class="number">1</span>;</span><br><span class="line">            model.variables[variable_light] = &#123;</span><br><span class="line">                <span class="string">"value"</span>: results.data[<span class="string">"light_value"</span>] * results.data[<span class="string">"light_count"</span>] * freq,</span><br><span class="line">                <span class="string">"count"</span>: results.data[<span class="string">"light_count"</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            model.variables[variable_light][variable_light] = <span class="number">1</span>;</span><br><span class="line">            model.constraints[variable_light] = &#123;</span><br><span class="line">                <span class="string">"min"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="string">"max"</span>: <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!(results.data[<span class="string">"wave_value"</span>] == <span class="string">" "</span> || results.data[<span class="string">"wave_value"</span>] == <span class="literal">null</span>)) &#123;</span><br><span class="line">            <span class="keyword">var</span> variable_wave = <span class="string">"v"</span> + idx + <span class="string">"2"</span>;</span><br><span class="line">            data_input[variable_wave] = results.data[<span class="string">"wave_value"</span>];</span><br><span class="line">            model.ints[variable_wave] = <span class="number">1</span>;</span><br><span class="line">            model.variables[variable_wave] = &#123;</span><br><span class="line">                <span class="string">"value"</span>: results.data[<span class="string">"wave_value"</span>] * results.data[<span class="string">"wave_count"</span>] * freq,</span><br><span class="line">                <span class="string">"count"</span>: results.data[<span class="string">"wave_count"</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            model.variables[variable_wave][variable_wave] = <span class="number">1</span>;</span><br><span class="line">            model.constraints[variable_wave] = &#123;</span><br><span class="line">                <span class="string">"min"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="string">"max"</span>: <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!(results.data[<span class="string">"current_value"</span>] == <span class="string">" "</span> || results.data[<span class="string">"current_value"</span>] == <span class="literal">null</span>)) &#123;</span><br><span class="line">            <span class="keyword">var</span> variable_current = <span class="string">"v"</span> + idx + <span class="string">"3"</span>;</span><br><span class="line">            data_input[variable_current] = results.data[<span class="string">"current_value"</span>];</span><br><span class="line">            model.ints[variable_current] = <span class="number">1</span>;</span><br><span class="line">            model.variables[variable_current] = &#123;</span><br><span class="line">                <span class="string">"value"</span>: results.data[<span class="string">"current_value"</span>] * results.data[<span class="string">"current_count"</span>] * freq,</span><br><span class="line">                <span class="string">"count"</span>: results.data[<span class="string">"current_count"</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            model.variables[variable_current][variable_current] = <span class="number">1</span>;</span><br><span class="line">            model.constraints[variable_current] = &#123;</span><br><span class="line">                <span class="string">"min"</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="string">"max"</span>: <span class="number">1</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        idx++;</span><br><span class="line">    &#125;,</span><br><span class="line">    complete: <span class="function"><span class="keyword">function</span>(<span class="params">results, parser</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">parseFloat</span>(<span class="built_in">document</span>.getElementById(<span class="string">"User"</span>).value));</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="built_in">document</span>.getElementById(<span class="string">"battery"</span>).value));</span><br><span class="line">        <span class="keyword">var</span> limits = days * <span class="built_in">parseFloat</span>(<span class="built_in">document</span>.getElementById(<span class="string">"User"</span>).value) + <span class="built_in">parseInt</span>(<span class="built_in">document</span>.getElementById(<span class="string">"battery"</span>).value);</span><br><span class="line">        model.constraints[<span class="string">"value"</span>] = &#123;</span><br><span class="line">            <span class="string">"min"</span>: limits</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">console</span>.log(model);</span><br><span class="line">        result = solver.Solve(model);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(result);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> wind_limit = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">var</span> light_limit = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">var</span> wave_limit = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">var</span> current_limit = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> result) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data_input.hasOwnProperty(key)) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(key + <span class="string">" -&gt; "</span> + data_input[key]);</span><br><span class="line">                <span class="keyword">switch</span> (<span class="built_in">parseInt</span>(key.slice(<span class="number">-1</span>))) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                        <span class="keyword">if</span> (wind_limit == <span class="number">-1</span>) wind_limit = data_input[key];</span><br><span class="line">                        <span class="keyword">if</span> (data_input[key] &lt;= wind_limit) wind_limit = data_input[key];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">//light</span></span><br><span class="line">                        <span class="keyword">if</span> (light_limit == <span class="number">-1</span>) light_limit = data_input[key];</span><br><span class="line">                        <span class="keyword">if</span> (data_input[key] &lt;= light_limit) light_limit = data_input[key];</span><br><span class="line">                        <span class="comment">// code block</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">//wave</span></span><br><span class="line">                        <span class="keyword">if</span> (wave_limit == <span class="number">-1</span>) wave_limit = data_input[key];</span><br><span class="line">        <span class="keyword">if</span> (data_input[key] &lt;= wave_limit) wave_limit = data_input[key];</span><br><span class="line">                        <span class="comment">// code block</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">//current</span></span><br><span class="line">                        <span class="keyword">if</span> (current_limit == <span class="number">-1</span>) current_limit = data_input[key];</span><br><span class="line">                        <span class="keyword">if</span> (data_input[key] &lt;= current_limit) current_limit = data_input[key];</span><br><span class="line">                        <span class="comment">// code block</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="comment">// code block</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="running"><a class="markdownIt-Anchor" href="#running"></a> Running</h2><p>Basically, this page is served as a Github page, you could visit at <a href="energy.shaokang.ga">energy.shaokang.ga</a>.</p><p>This website also has a lightweight localization, which will switch between ZH-CN and EN-US based on the system configuration. This is a pure static page with JavaScript. So anybody is able to host it easily on your own. If you don’t need to see some 3d effects, just download and click on each file would work. 3D effects require some cross-server interaction.</p><p>To run it and see the 3d effects, the way I use is to install <a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">Node.js</a> at first. Then install the http-server using <code>npm install --global http-server</code>. Then do the following in any directory:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ShaokangJiang/energy.git</span><br><span class="line"><span class="built_in">cd</span> energy</span><br><span class="line">http-server</span><br></pre></td></tr></table></figure><p>Then go to browser and go to <code>127.0.0.1:8080</code> should work.</p><h3 id="interactive-content"><a class="markdownIt-Anchor" href="#interactive-content"></a> Interactive content</h3><h4 id="3d-model"><a class="markdownIt-Anchor" href="#3d-model"></a> 3D model</h4><p>3D model with real time running information is available while running. This is done by using <a href="https://aframe.io/" target="_blank" rel="noopener">A-Frame</a> with Three.js</p><h4 id="ar"><a class="markdownIt-Anchor" href="#ar"></a> AR</h4><p>By scanning specific pattern, it is able to load model in reality. <code>/ar.html</code> and <code>/ar1.html</code> provide two different ways, one is scanning via QR code, the other way is through scanning the 2D version of this 3D model, this is done based on machine learning of the configured pattern.</p><h4 id="wonderful-charts"><a class="markdownIt-Anchor" href="#wonderful-charts"></a> Wonderful charts</h4><p>When hovering mouse on each card, it is able to plot the energy production in the past 10 time durations.</p><h2 id="data-format"><a class="markdownIt-Anchor" href="#data-format"></a> Data format:</h2><h4 id="simulation-data"><a class="markdownIt-Anchor" href="#simulation-data"></a> Simulation data</h4><p>Header should be the same, <code>User_Usage</code> is not required but recommend. Each field represent the value sensor received.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Time,Wind_Speed,Light_H,Wave_Hight,Wave_Period,Current_Speed,User_Usage</span><br><span class="line">0,5.405,1213.072,3.591,9.104,1.846,501.5935</span><br><span class="line">0.2,8.157,1191.057,3.022,10.431,1.908,497.0755</span><br><span class="line">0.4,6.012,1197.794,1.709,8.784,1.936,503.0145</span><br><span class="line">0.6,6.477,1205.489,2.1,9.857,1.858,499.4511</span><br></pre></td></tr></table></figure><p>Download a sample from <a href="https://github.com/ShaokangJiang/energy/blob/master/sample/simulation%20data.csv" target="_blank" rel="noopener">here</a>.</p><h4 id="optimization-data"><a class="markdownIt-Anchor" href="#optimization-data"></a> Optimization data</h4><p>Header should be the same, <code>idx</code> is not required. Each category has a value component recoding the amount of power produced in unit time. Each count means the possibility of happening. Because we need to use a KWH = b KW * s/3600 to calculate energy produced. The count field has to be integer. We could use the possibility * a factor to make it become integer. And the sum of each count should be the same.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">idx,wind_value,wind_count,light_value,light_count,wave_value,wave_count,current_value,current_count</span><br><span class="line">0,4962654.905,189,100.8496541,45,485.3900022,222,71501.61128,105</span><br><span class="line">1,424133.8855,45,105.8598321,124,328.6975665,43,49752.79798,187</span><br><span class="line">2,3414695.961,18,113.1989172,130,438.1380705,33,35910.75581,12</span><br><span class="line">3,7346795.761,90,116.4237558,11,483.7242291,24,48819.12566,25</span><br><span class="line">4,4033868.032,20,105.5786618,25,226.1068017,14,1611.378029,35</span><br><span class="line">5, , ,106.0583865,19,364.8009734,10,19265.12771,1</span><br></pre></td></tr></table></figure><p>Download a sample from <a href="https://github.com/ShaokangJiang/energy/blob/master/sample/OptimizationData.csv" target="_blank" rel="noopener">here</a>.</p><h2 id="generate-fake-simulation-and-optimization-data"><a class="markdownIt-Anchor" href="#generate-fake-simulation-and-optimization-data"></a> Generate Fake Simulation and optimization data</h2><h4 id="fake-simulation-data"><a class="markdownIt-Anchor" href="#fake-simulation-data"></a> Fake simulation data</h4><p>Use java code below to generate fake simulation data(to be used in run page).</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Random r = <span class="keyword">new</span> Random();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">  FileWriter a = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(<span class="string">"1.csv"</span>));</span><br><span class="line">  a.write(<span class="string">"Wind_Speed,Light_H,Wave_Hight,Wave_Period,Current_Speed\r\n"</span>);</span><br><span class="line">  <span class="keyword">double</span> time = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(time&lt;<span class="number">36</span>) &#123;</span><br><span class="line">    a.write(generateNormalVar(<span class="number">8</span>,<span class="number">2</span>)+<span class="string">","</span>+generateNormalVar(<span class="number">1200</span>,<span class="number">50</span>)+</span><br><span class="line">        <span class="string">","</span>+generateNormalVar(<span class="number">2.5</span>,<span class="number">0.25</span>)+<span class="string">","</span>+generateNormalVar(<span class="number">9</span>,<span class="number">0.5</span>)+<span class="string">","</span>+generateNormalVar(<span class="number">2</span>,<span class="number">0.5</span>)+<span class="string">"\r\n"</span>);</span><br><span class="line">    time+=<span class="number">0.2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  a.flush();</span><br><span class="line">  a.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * N(a,b)</span></span><br><span class="line"><span class="comment"> * center,distribution</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> x</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> y</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">generateNormalVar</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">double</span> x = Math.sqrt(b)*r.nextGaussian()+a;</span><br><span class="line">  r.nextGaussian();</span><br><span class="line">  <span class="keyword">return</span> String.format(<span class="string">"%.3f"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="fake-optimization-data"><a class="markdownIt-Anchor" href="#fake-optimization-data"></a> Fake optimization data</h4><ul><li><p>To make the input source be easy to manage, represent and maintain. We could save them in the same file, if no enough data for a cell, leave it empty would be fine and recommended.</p></li><li><p>idx is not required but recommended</p></li><li><p>This generation code might be good enough as this is not the real case</p></li><li><p>header: idx,wind_value,wind_count,light_value,light_count,wave_value,wave_count,current_value,current_count</p></li></ul><p>Use java code below to generate fake optimization data(to be used in start page):</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">  FileWriter a = <span class="keyword">new</span> FileWriter(<span class="keyword">new</span> File(<span class="string">"1.csv"</span>));</span><br><span class="line">a.write(<span class="string">"idx,wind_value,wind_count,light_value,light_count,wave_value,wave_count,current_value,current_count\r\n"</span>);</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> year = <span class="number">365</span>;</span><br><span class="line">  <span class="keyword">int</span> wind_count=year,light_count=year,wave_count=year,current_count=year;</span><br><span class="line">  <span class="keyword">while</span>(wind_count&gt;<span class="number">0</span> || light_count&gt;<span class="number">0</span> || wave_count&gt;<span class="number">0</span> || current_count&gt;<span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">int</span> wind_count_=generateRandomIntegerIn(wind_count),light_count_=generateRandomIntegerIn(light_count),</span><br><span class="line">        wave_count_=generateRandomIntegerIn(wave_count),current_count_=generateRandomIntegerIn(current_count);</span><br><span class="line">    wind_count -= wind_count_;</span><br><span class="line">    light_count -= light_count_;</span><br><span class="line">    wave_count -= wave_count_;</span><br><span class="line">    current_count -= current_count_;</span><br><span class="line">    <span class="keyword">if</span>(wind_count_==<span class="number">0</span>&amp;&amp;light_count_==<span class="number">0</span>&amp;&amp;wave_count_==<span class="number">0</span>&amp;&amp;current_count_==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">double</span> Wind_Speed=generateRandomDoubleIn(<span class="number">4</span>,<span class="number">15</span>),Light_H=generateRandomDoubleIn(<span class="number">1100</span>,<span class="number">1300</span>),</span><br><span class="line">        Wave_Hight=generateRandomDoubleIn(<span class="number">2</span>,<span class="number">3</span>),Wave_Period=generateRandomDoubleIn(<span class="number">7</span>,<span class="number">11</span>),</span><br><span class="line">        Current_Speed=generateRandomDoubleIn(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">    System.out.println(count+<span class="string">""</span>+wind_count+<span class="string">""</span>+light_count+<span class="string">""</span>+wave_count+<span class="string">""</span>+current_count+<span class="string">""</span>);</span><br><span class="line">    a.write(count + <span class="string">","</span>+ (wind_count_ == <span class="number">0</span> ? <span class="string">" "</span> : <span class="number">2866</span>*Wind_Speed*Wind_Speed*Wind_Speed) +<span class="string">","</span>+(wind_count_ == <span class="number">0</span> ? <span class="string">" "</span> : wind_count_) +<span class="string">","</span>+</span><br><span class="line">          (light_count_ == <span class="number">0</span> ? <span class="string">" "</span> : <span class="number">0.09</span>*Light_H) +<span class="string">","</span>+(light_count_ == <span class="number">0</span> ? <span class="string">" "</span> : light_count_) +<span class="string">","</span>+</span><br><span class="line">        (wave_count_ == <span class="number">0</span> ? <span class="string">" "</span> : <span class="number">6.6</span>*Wave_Hight*Wave_Hight*Wave_Period)+<span class="string">","</span>+(wave_count_ == <span class="number">0</span> ? <span class="string">" "</span> : wave_count_)+<span class="string">","</span>+</span><br><span class="line">          (current_count_ == <span class="number">0</span> ? <span class="string">" "</span> : <span class="number">1254</span>*Current_Speed*Current_Speed*Current_Speed )+<span class="string">","</span>+(current_count_ == <span class="number">0</span> ? <span class="string">" "</span> : current_count_)+<span class="string">"\r\n"</span>);</span><br><span class="line">    count++;</span><br><span class="line">  &#125;</span><br><span class="line">  a.flush();</span><br><span class="line">  a.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//0~h</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">generateRandomIntegerIn</span><span class="params">(<span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ThreadLocalRandom.current().nextInt(<span class="number">0</span>, h + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">generateRandomDoubleIn</span><span class="params">(<span class="keyword">int</span> Min, <span class="keyword">int</span> Max)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Min + (Math.random() * ((Max - Min) + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="usage"><a class="markdownIt-Anchor" href="#usage"></a> Usage</h3><p><span>Each field means the threshold of each component except wave. In the case of wave, the threshold needs to be pre-calculated using </span>$H^2T$. <span>User usage is in kwh per day or unit time, the unit time refers to the refresh frequency, which will be used to calculate energy produced in the frame of time.</span></p><p>The way to calculate energy produced per unit time: a KWH = b KW*s/3600, a is the result, b is the current power, a is the calculated energy. s is the refresh frequency. Refresh frequency in this form is in ms(milliseconds).</p><p>In the manual setting, you are able to choose to provide user usage data in the future, usually this means to have a column of data recording user consumption per unit time, it will be used as a source of consumming power. If that file doesn't have user usage, you could set it at here. In the auto generate mode, you have to provide one to let us find the optimal solution(guess a possible one would be fine).</p><h3 id="calculation-equation"><a class="markdownIt-Anchor" href="#calculation-equation"></a> Calculation Equation</h3><p><b>Wave</b>: $P_{total}=0.6*11*H^2T=6.6H^2T$ <span>H - height of wave T - period</span></p><p><b>Ocean Current</b>: $P=\frac{\rho v^3 S C_p}{2}=\frac{1050 v^3 \pi1.3^2* 0.45}{2}=1254v^3$ <span>P is the energy captured by the unit, ρ is the fluid density, V is the fluid velocity, and S is the swept area of the impeller</span>$C_p$<span> is the energy utilization coefficient</span></p><p><b>Light</b>: $P=\frac{798*H_A}{365*24}=0.09*H_A, H_A$ <span>Total solar radiation per unit area</span></p><p><b>Wind</b>: $P=\frac{\rho v^3 S C_p}{2}=\frac{1.293 v^3 9852* 0.45}{2}=2866v^3$ <span>P is the energy captured by the unit, ρ is the fluid density, V is the fluid velocity, and S is the swept area of the impeller</span>$C_p$<span> is the energy utilization coefficient</span></p><h2 id="requirement"><a class="markdownIt-Anchor" href="#requirement"></a> Requirement</h2><p>Because I used the class technique to build LinkedList to use in generating charts, IE is not supported. And there are some requirements for the majority browser as well, see compatibility data at <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Browser_compatibility" target="_blank" rel="noopener">NPM official site</a>. Other than the LinkedList, most of features should work in IE 11.</p><h2 id="js-libraries-used"><a class="markdownIt-Anchor" href="#js-libraries-used"></a> JS libraries used</h2><ul><li><a href="https://echarts.apache.org/en/index.html" target="_blank" rel="noopener">echarts</a></li><li><a href="https://materializecss.com/" target="_blank" rel="noopener">Materialcss</a></li><li><a href="https://aframe.io/" target="_blank" rel="noopener">A-frame</a></li><li><a href="https://ar-js-org.github.io/AR.js-Docs/" target="_blank" rel="noopener">AR.js</a></li><li><a href="https://www.papaparse.com/" target="_blank" rel="noopener">PapaParse</a></li><li><a href="https://jquery.com/" target="_blank" rel="noopener">Jquery</a></li><li><a href="https://github.com/tizzle/aframe-orbit-controls-component" target="_blank" rel="noopener">aframe-orbit-controls-component</a></li><li><a href="https://github.com/JWally/jsLPSolver" target="_blank" rel="noopener">jsLPSolver</a></li></ul><h2 id="changelog"><a class="markdownIt-Anchor" href="#changelog"></a> ChangeLog</h2><ol><li><p>5/25/2020 Core running function finished &amp; Time field in input simulation file is not required</p></li><li><p>5/26/2020 Multi-language added</p></li><li><p>5/27/2020 Optimize font and icon loading</p></li><li><p>5/29/2020 Optimization to find best history result function added &amp; multi-file reading is not allowed in run page now</p></li><li><p>5/30/2020 User can now use the first 30 seconds of data to run and optimize threshold.</p></li><li><p>5/31/2020 More verification, notification added. Framework for displaying VR and AR is ready. Supported via <a href="https://energy.shaokang.ga/test.html" target="_blank" rel="noopener">static webpage</a>, <a href="https://energy.shaokang.ga/qr.png" target="_blank" rel="noopener">qrCode</a>, and also in running page.</p><p>For AR in static page, your device needs meet WebXR requirement:</p><blockquote><p>AR is also a standard and you can experiment today on <strong>Android ARCore compatible</strong> devices and <strong>Chrome 79</strong> or newer.<br>Enable the experimental WebXR AR module in <strong>chrome://flags</strong></p></blockquote></li><li><p>6/6/2020 All parts of 3d model is done.</p></li></ol></div><section class="meta" id="footer-meta"><hr><div class="new-meta-box"><div class="new-meta-item date" itemprop="dateUpdated" datetime="2021-01-15T21:56:12-06:00"><a class="notlink"><i class="fas fa-clock" aria-hidden="true"></i><p>last updated at Jan 15, 2021</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/MIP/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>MIP</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/jsLpsolver/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>jsLpsolver</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/Three-js/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>Three.js</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/A-Frame/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>A-Frame</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/AR-js/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>AR.js</p></a></div></div></section><div class="prev-next"><section class="prev"><span class="art-item-left"><h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;Previous</h6><h4><a href="/2020/projects/Energy-simulation-JavaFx-ver/" rel="prev" title="Energy simulation Javafx version">Energy simulation Javafx version</a></h4><h6 class="tags"><a class="tag" href="/tags/MIP/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>MIP</a> <a class="tag" href="/tags/JavaFX/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>JavaFX</a> <a class="tag" href="/tags/choco-solver/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>choco-solver</a> <a class="tag" href="/tags/JFoenix/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>JFoenix</a></h6></span></section><section class="next"><span class="art-item-right" aria-hidden="true"><h6>Next&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6><h4><a href="/2020/projects/639-project/" rel="prev" title="639 project">639 project</a></h4><h6 class="tags"><a class="tag" href="/tags/Self-learning/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Self learning</a></h6></span></section></div></section></article><article class="post white-box comments"><section class="article typo"><h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;Comments</h4><section id="comments"><div id="valine_container" class="valine_thread"><i class="fas fa-spinner fa-spin fa-fw"></i></div></section></section></article><script>window.subData={title:"Energy simulation website",tools:!0}</script><script>window.subData={title:"Energy simulation website",tools:!0}</script><script>document.addEventListener("DOMContentLoaded",(function(){self.frameElement&&"IFRAME"==self.frameElement.tagName&&(document.getElementById("cover-wrapper-cover").innerHTML="",document.getElementById("aside_l_side").innerHTML="")}))</script></div><aside id="aside_l_side" class="l_side"><section class="widget toc-wrapper"><header class="material"><div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;TOC</div><div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div></header><div class="content material"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ways-of-analyzing-history-data"><span class="toc-text">Ways of analyzing history data</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#define-variables"><span class="toc-text">Define variables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optimization-model"><span class="toc-text">Optimization Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-to-solve-it"><span class="toc-text">Code to solve it</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#running"><span class="toc-text">Running</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#interactive-content"><span class="toc-text">Interactive content</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3d-model"><span class="toc-text">3D model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ar"><span class="toc-text">AR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wonderful-charts"><span class="toc-text">Wonderful charts</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#data-format"><span class="toc-text">Data format:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#simulation-data"><span class="toc-text">Simulation data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#optimization-data"><span class="toc-text">Optimization data</span></a></li></ol></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-fake-simulation-and-optimization-data"><span class="toc-text">Generate Fake Simulation and optimization data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fake-simulation-data"><span class="toc-text">Fake simulation data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fake-optimization-data"><span class="toc-text">Fake optimization data</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usage"><span class="toc-text">Usage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#calculation-equation"><span class="toc-text">Calculation Equation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#requirement"><span class="toc-text">Requirement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js-libraries-used"><span class="toc-text">JS libraries used</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#changelog"><span class="toc-text">ChangeLog</span></a></li></div></section><section class="widget category"><header class="material"><div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Categories</div><a class="rightBtn" rel="nofollow" href="/categories/" title="categories/"><i class="fas fa-expand-arrows-alt fa-fw"></i></a></header><div class="content material"><ul class="entry"><li><a class="flat-box" title="/categories/Cryptocurrency-Application/" href="/categories/Cryptocurrency-Application/"><div class="name">Cryptocurrency Application</div><div class="badge">(4)</div></a></li><li><a class="flat-box child" title="/categories/Cryptocurrency-Application/Bitcoin/" href="/categories/Cryptocurrency-Application/Bitcoin/"><div class="name">Bitcoin</div><div class="badge">(1)</div></a></li><li><a class="flat-box child" title="/categories/Cryptocurrency-Application/EOSIO/" href="/categories/Cryptocurrency-Application/EOSIO/"><div class="name">EOSIO</div><div class="badge">(3)</div></a></li><li><a class="flat-box" title="/categories/Expo/" href="/categories/Expo/"><div class="name">Expo</div><div class="badge">(4)</div></a></li><li><a class="flat-box" title="/categories/Programs/" href="/categories/Programs/"><div class="name">Programs</div><div class="badge">(5)</div></a></li><li><a class="flat-box child" title="/categories/Programs/Coursework/" href="/categories/Programs/Coursework/"><div class="name">Coursework</div><div class="badge">(3)</div></a></li><li><a class="flat-box child" title="/categories/Programs/tools/" href="/categories/Programs/tools/"><div class="name">tools</div><div class="badge">(2)</div></a></li><li><a class="flat-box" title="/categories/optimization/" href="/categories/optimization/"><div class="name">optimization</div><div class="badge">(4)</div></a></li><li><a class="flat-box" title="/categories/website/" href="/categories/website/"><div class="name">website</div><div class="badge">(9)</div></a></li><li><a class="flat-box child" title="/categories/website/Cloudflare-Worker/" href="/categories/website/Cloudflare-Worker/"><div class="name">Cloudflare Worker</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/website/Hexo/" href="/categories/website/Hexo/"><div class="name">Hexo</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/website/JS/" href="/categories/website/JS/"><div class="name">JS</div><div class="badge">(1)</div></a></li></ul></div></section><section class="widget tagcloud"><header class="material"><div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Hot Tags</div><a class="rightBtn" rel="nofollow" href="/tags/" title="tags/"><i class="fas fa-expand-arrows-alt fa-fw"></i></a></header><div class="content material"><a href="/tags/A-Frame/" style="font-size:14px;color:#999">A-Frame</a> <a href="/tags/AES/" style="font-size:14px;color:#999">AES</a> <a href="/tags/AR-js/" style="font-size:14px;color:#999">AR.js</a> <a href="/tags/Bitcoin/" style="font-size:14px;color:#999">Bitcoin</a> <a href="/tags/Dialogflow/" style="font-size:14px;color:#999">Dialogflow</a> <a href="/tags/Expo/" style="font-size:22px;color:#636363">Expo</a> <a href="/tags/GAMS/" style="font-size:16px;color:#8b8b8b">GAMS</a> <a href="/tags/HTML/" style="font-size:18px;color:#7e7e7e">HTML</a> <a href="/tags/JFoenix/" style="font-size:14px;color:#999">JFoenix</a> <a href="/tags/JS/" style="font-size:20px;color:#707070">JS</a> <a href="/tags/Java/" style="font-size:16px;color:#8b8b8b">Java</a> <a href="/tags/JavaFX/" style="font-size:16px;color:#8b8b8b">JavaFX</a> <a href="/tags/MIP/" style="font-size:24px;color:#555">MIP</a> <a href="/tags/Nlp-js/" style="font-size:20px;color:#707070">Nlp.js</a> <a href="/tags/Notes/" style="font-size:14px;color:#999">Notes</a> <a href="/tags/SQL/" style="font-size:16px;color:#8b8b8b">SQL</a> <a href="/tags/Self-learning/" style="font-size:14px;color:#999">Self learning</a> <a href="/tags/Three-js/" style="font-size:14px;color:#999">Three.js</a> <a href="/tags/Website/" style="font-size:20px;color:#707070">Website</a> <a href="/tags/choco-solver/" style="font-size:14px;color:#999">choco-solver</a> <a href="/tags/ejs/" style="font-size:16px;color:#8b8b8b">ejs</a> <a href="/tags/eos/" style="font-size:18px;color:#7e7e7e">eos</a> <a href="/tags/eos-cdt/" style="font-size:18px;color:#7e7e7e">eos.cdt</a> <a href="/tags/eosio-contracts/" style="font-size:18px;color:#7e7e7e">eosio.contracts</a> <a href="/tags/jsLpsolver/" style="font-size:14px;color:#999">jsLpsolver</a></div></section><section class="widget related_posts"><header class="material"><div><i class="fas fa-bookmark fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;Related Posts</div></header><div class="content material"><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2020/Financial-organization-phone-application/" title="Financial organization phone app - stage 1" rel="bookmark">Financial organization phone app - stage 1</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2020/Optimal-Energy-Production/" title="Optimal Energy Production" rel="bookmark">Optimal Energy Production</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2020/projects/Energy-simulation-JavaFx-ver/" title="Energy simulation Javafx version" rel="bookmark">Energy simulation Javafx version</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2020/projects/Publication-of-Financial-website/" title="Publication for Financial website" rel="bookmark">Publication for Financial website</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2019/projects/College-library-optimization-problem/" title="College library optimization problem" rel="bookmark">College library optimization problem</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="/2020/Capstone-prooject-design-specification-v0-1/" title="Capstone project design specification" rel="bookmark">Capstone project design specification</a></h3></div></li></ul></div></section></aside><footer id="footer" class="clearfix"><div class="footer"></div><br><div class="social-wrapper"><a href="mailto:huangsk100@gmail.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/ShaokangJiang" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/sjiang97" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div><br><div><p>Powered by <a href="https://hexo.io/">Hexo</a>. Use <a href="https://xaoxuu.com/wiki/material-x/">Material-X</a> as theme.</p></div></footer><script>setLoadingBarProgress(80)</script><script>setLoadingBarProgress(60)</script></div><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script>var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="",AZURE_INDEX_NAME="",AZURE_QUERY_KEY="",BAIDU_API_ID="",SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script><script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script><script type="text/javascript">$((function(){0!==$(".reveal").length&&ScrollReveal({distance:0}).reveal(".reveal")}))</script><script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$((function(){Waves.attach(".flat-btn",["waves-button"]),Waves.attach(".float-btn",["waves-button","waves-float"]),Waves.attach(".float-btn-light",["waves-button","waves-float","waves-light"]),Waves.attach(".flat-box",["waves-block"]),Waves.attach(".float-box",["waves-block","waves-float"]),Waves.attach(".waves-image"),Waves.init()}))</script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script><script type="text/javascript">$((function(){$(".cover").backstretch(["https://img.vim-cn.com/6d/a0c9e6f9efad8b731cb7376504bd10d79d2053.jpg"],{duration:"6000",fade:"2500"})}))</script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-valine@1.3.4/js/valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter((function(i){return GUEST_INFO.indexOf(i)>-1})),notify=!1,verify=!1,valine=new Valine;valine.init({el:"#valine_container",notify:notify,verify:verify,guest_info:guest_info,appId:"g0v2qyGEhGys4wGpCLsKkerW-gzGzoHsz",appKey:"Sceumpu0A14EiY5RR3HtsCFx",placeholder:"",pageSize:"10",avatar:"mp",lang:"en",highlight:"false"})</script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.4.19/js/app.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.4.19/js/search.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>let COPY_SUCCESS="Copied",COPY_FAILURE="Copy failed";window,document,function(){$(".highlight .code pre").before('<button class="btn-copy" data-clipboard-snippet="">  <i class="fa fa-copy"></i><span>Copy</span></button>');var o=new ClipboardJS(".btn-copy",{target:function(o){return o.nextElementSibling}});o.on("success",(function(o){console.info("Action:",o.action),console.info("Text:",o.text),console.info("Trigger:",o.trigger),success_prompt(COPY_SUCCESS),o.clearSelection()})),o.on("error",(function(o){console.error("Action:",o.action),console.error("Trigger:",o.trigger),fail_prompt(COPY_FAILURE)}))}();var prompt=function(o,n,t){n=void 0===n?"alert-success":n,t=void 0===t?1500:1e3*t,$("<div>").appendTo("body").addClass("alert "+n).html(o).show().delay(t).fadeOut()},success_prompt=function(o,n){prompt(o,"alert-success",n)},fail_prompt=function(o,n){prompt(o,"alert-danger",n)},warning_prompt=function(o,n){prompt(o,"alert-warning",n)},info_prompt=function(o,n){prompt(o,"alert-info",n)}</script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>let LAZY_LOAD_IMAGE="";$(".article-entry").find("fancybox").find("img").each((function(){var t=document.createElement("a");$(t).attr("data-fancybox","gallery"),$(t).attr("href",$(this).attr("src")),LAZY_LOAD_IMAGE&&$(t).attr("href",$(this).attr("data-original")),$(this).wrap(t)}))</script><script>setLoadingBarProgress(100)</script></body></html>